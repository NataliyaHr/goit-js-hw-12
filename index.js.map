{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport default class pixabayApi {\n  BASE_URL = 'https://pixabay.com/api/';\n  currentPage = 1;\n  resultsPerPage = 15;\n  totalPages = 0;\n  query = '';\n  constructor(apiKey) {\n    this.apiKey = apiKey;\n  }\n\n  async getImageList() {\n    const searchParams = {\n      params: {\n        key: this.apiKey,\n        q: this.query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page: this.currentPage,\n        per_page: this.resultsPerPage,\n      },\n    };\n    try {\n      const response = await axios.get(this.BASE_URL, searchParams);\n      this.totalPages = Math.ceil(response.data.totalHits / 15);\n      return response.data.hits;\n    } catch {\n      throw new Error('something went wrong');\n    }\n  }\n}","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport function getHtmlImageList(iamgesList) {\n  if (iamgesList.length <= 0) {\n    iziToast.error({\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      progressBar: false,\n      transitionIn: 'fadeIn',\n      position: 'topRight',\n    });\n    return 'no images found';\n  } else {\n    const htmlImagesList = iamgesList\n      .map(\n        image =>\n          `<li class=\"gallery-item\">\n            <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n              <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" width=\"360\" height=\"200\">\n            </a>\n            <ul class=\"gallery-item-desc\">\n              <li class=\"gallery-item-desc-item\"><span class=\"gallery-item-desc-cap\">Likes</span><span>${image.likes}</span></li>\n              <li class=\"gallery-item-desc-item\"><span class=\"gallery-item-desc-cap\">Views</span><span>${image.views}</span></li>\n              <li class=\"gallery-item-desc-item\"><span class=\"gallery-item-desc-cap\">Comments</span><span>${image.comments}</span></li>\n              <li class=\"gallery-item-desc-item\"><span class=\"gallery-item-desc-cap\">Downloads</span><span>${image.downloads}</span></li>\n            </ul>\n          </li>`\n      )\n      .join('');\n    return htmlImagesList;\n  }\n}\nexport function renderGallery(htmlImageList, galleryList) {\n  galleryList.insertAdjacentHTML('beforeend', htmlImageList);\n}","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport pixabayApi from './js/pixabay-api';\nimport { renderGallery, getHtmlImageList } from './js/render-functions';\n\nconst galleryList = document.querySelector('.gallery-list');\nconst queryToSearch = document.querySelector('.search-form-input');\nconst submitQuery = document.querySelector('.search-form');\nconst loader = document.querySelector('.loader');\nconst loadMoreButton = document.querySelector('.load-more-button');\nconst API_KEY = '44799740-e5447d6b9b58b3b9f4f848c49';\n\nconst pixabay = new pixabayApi(API_KEY);\nconst gallery = new SimpleLightbox('.gallery-list a', {\n  captionDelay: 250,\n  captionsData: 'alt',\n});\n\nasync function searchImages(e) {\n  e.preventDefault();\n  galleryList.innerHTML = '';\n  pixabay.currentPage = 1;\n  pixabay.query = queryToSearch.value;\n  htmlElementVisible(loadMoreButton, false);\n\n  if (isValidQuery(pixabay.query)) {\n    htmlElementVisible(loader, true);\n    try {\n      const imageList = await pixabay.getImageList();\n      htmlElementVisible(loader, false);\n      \n      if (imageList.length > 0) {\n        const htmlImageList = getHtmlImageList(imageList);\n        renderGallery(htmlImageList, galleryList);\n        gallery.refresh();\n        \n        if (pixabay.totalPages > 1) {\n          htmlElementVisible(loadMoreButton, true);\n        }\n      } else {\n        iziToast.info({\n          message: 'No images found',\n          progressBar: false,\n          transitionIn: 'fadeIn',\n          position: 'topRight',\n        });\n      }\n    } catch (error) {\n      htmlElementVisible(loader, false);\n      iziToast.error({\n        message: 'An error occurred while fetching images. Please try again later.',\n        progressBar: false,\n        transitionIn: 'fadeIn',\n        position: 'topRight',\n      });\n      console.error(\"Error fetching images:\", error);\n    }\n  } else {\n    iziToast.error({\n      message: 'Search attribute is not valid',\n      progressBar: false,\n      transitionIn: 'fadeIn',\n      position: 'topRight',\n    });\n  }\n}\n\nasync function loadMoreImages(e) {\n  e.preventDefault();\n  pixabay.currentPage += 1;\n  htmlElementVisible(loader, true);\n  htmlElementVisible(loadMoreButton, false);\n\n  try {\n    const imageList = await pixabay.getImageList();\n    htmlElementVisible(loader, false);\n    \n    if (imageList.length > 0) {\n      const htmlImageList = getHtmlImageList(imageList);\n      renderGallery(htmlImageList, galleryList);\n      gallery.refresh();\n\n      const listItemHeight = document.querySelector('.gallery-item');\n      if (listItemHeight) {\n        window.scrollBy({\n          top: listItemHeight.getBoundingClientRect().height * 2,\n          behavior: 'smooth',\n        });\n      }\n\n      if (pixabay.totalPages === pixabay.currentPage) {\n        htmlElementVisible(loadMoreButton, false);\n        iziToast.info({\n          message: `We're sorry, but you've reached the end of search results.`,\n          progressBar: false,\n          transitionIn: 'fadeIn',\n          position: 'topRight',\n        });\n      } else {\n        htmlElementVisible(loadMoreButton, true);\n      }\n    } else {\n      iziToast.info({\n        message: 'No more images found',\n        progressBar: false,\n        transitionIn: 'fadeIn',\n        position: 'topRight',\n      });\n    }\n  } catch (error) {\n    htmlElementVisible(loader, false);\n    iziToast.error({\n      message: 'An error occurred while loading more images. Please try again later.',\n      progressBar: false,\n      transitionIn: 'fadeIn',\n      position: 'topRight',\n    });\n    console.error(\"Error loading more images:\", error);\n  }\n}\n\n\nfunction isValidQuery(queryToSearch) {\n  if (queryToSearch.trim() === '') {\n    return false;\n  } else {\n    return true;\n  }\n}\n\nfunction htmlElementVisible(element, isVisible = false) {\n  if (isVisible) {\n    element.classList.remove('hidden');\n  } else {\n    element.classList.add('hidden');\n  }\n}\n\nsubmitQuery.addEventListener('submit', searchImages);\nloadMoreButton.addEventListener('click', loadMoreImages);"],"names":["pixabayApi","apiKey","__publicField","searchParams","response","axios","getHtmlImageList","iamgesList","iziToast","image","renderGallery","htmlImageList","galleryList","queryToSearch","submitQuery","loader","loadMoreButton","API_KEY","pixabay","gallery","SimpleLightbox","searchImages","e","htmlElementVisible","isValidQuery","imageList","error","loadMoreImages","listItemHeight","element","isVisible"],"mappings":"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"}